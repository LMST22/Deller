<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Aktuelles</title>
  <style>
    /* === GRUNDLEGENDES LAYOUT === */
    /* Basis-Styling für den Body - Flexbox Layout für Vollbild-App */
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #fff;
      color: #111;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden; /* Verhindert Scrollen des gesamten Bodys */
    }

    /* === HEADER MIT PROFIL-MENÜ === */
    /* Header mit Titel und Profil-Button */
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 2vh 4vw;
      font-size: 2.5vh;
      font-weight: bold;
    }

    /* Profil-Button Styling */
    .profile-button {
      background: none;
      border: none;
      padding: 0;
      cursor: pointer;
    }

    /* Runder Profil-Icon Container */
    .profile-icon {
      width: 5vh;
      height: 5vh;
      border-radius: 50%;
      background-color: #eee;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
    }

    .profile-icon img {
      width: 70%;
      height: 70%;
      object-fit: contain;
      filter: invert(1); /* Macht das Icon weiß */
    }

    /* Dropdown-Menü für das Profil (versteckt standardmäßig) */
    .profile-menu {
      position: absolute;
      top: 8vh;
      right: 2vw;
      width: 180px;
      background: #f5f5f5;
      border: 4px solid #999;
      border-radius: 12px;
      padding: 16px;
      display: none; /* Versteckt bis aktiviert */
      flex-direction: column;
      align-items: center;
      gap: 16px;
      z-index: 10;
    }

    .profile-menu.active {
      display: flex; /* Zeigt das Menü an */
    }

    /* Schließen-Button für das Profil-Menü */
    .close-button {
      position: absolute;
      top: 8px;
      right: 8px;
      background: none;
      border: none;
      font-size: 20px;
      font-weight: bold;
      color: black;
      cursor: pointer;
    }

    /* Icon-Wrapper für das Profil-Menü */
    .icon-wrapper {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background-color: #ddd;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .icon-wrapper img {
      width: 60%;
      height: 60%;
      object-fit: contain;
      filter: invert(1);
    }

    /* Logout-Button Styling */
    .logout-button {
      background: #ffdddd;
      border: 3px solid red;
      color: black;
      font-weight: bold;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      outline: none;
      appearance: none;
      -webkit-appearance: none;
      -webkit-tap-highlight-color: transparent;
    }

    .logout-button:hover {
      background-color: #ffe6e6;
    }

    .logout-button:focus,
    .logout-button:active {
      outline: none;
      background-color: #ffcccc;
      border-color: darkred;
    }

    /* === HAUPTINHALT === */
    /* Scrollbarer Hauptinhalt zwischen Header und Footer */
    .content {
      flex: 1;
      overflow-y: auto;
      padding: 0 4vw 10vh;
    }

    /* === SECTION LABELS === */
    /* Farbige Labels für "Relevant" und "Unspektakulär" */
    .section-label {
      font-size: 2vh;
      font-weight: bold;
      padding: 0.4rem 0.8rem;
      border-radius: 6px;
      margin: 2vh 0;
      display: inline-block;
    }

    .red-label {
      background-color: #c00;
      color: white;
    }

    .purple-label {
      background-color: #592ff1;
      color: white;
      font-weight: bold;
    }

    /* === KARTEN-LAYOUT === */
    /* Styling für die News-Karten */
    .card {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 2px solid #888;
      border-radius: 12px;
      padding: 2vh 2vw;
      margin-bottom: 2vh;
    }

    /* Linke Seite der Karte mit Titel und Datum */
    .card-info {
      display: flex;
      flex-direction: column;
    }

    .card-header {
      font-weight: bold;
      margin-bottom: 0.5vh;
    }

    .card-sub {
      font-size: 1.5vh;
      color: #555;
    }

    /* Rechte Seite der Karte mit Trend und Buttons */
    .card-right {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 1vh;
    }

    /* Trend-Farben für Aktien/Kurse */
    .green {
      color: green;
    }

    .red {
      color: red;
    }

    /* Favoriten-Button (Stern) */
    .favorite-button {
      background: none;
      border: none;
      font-size: 2vh;
      cursor: pointer;
      color: #999;
      transition: color 0.2s ease;
    }

    .favorite-button.favorited {
      color: gold; /* Goldener Stern für favorisierte Items */
    }

    /* === FILTER-DROPDOWN === */
    /* Container für Filter-Dropdown */
    .filter-wrapper {
      position: relative;
      display: inline-block;
      margin: 2vh 0;
    }

    .filter-button {
      background-color: transparent;
      border: none;
      color: #111;
      font-size: 2vh;
      font-weight: bold;
      cursor: pointer;
      padding: 1vh 2vw;
    }

    /* Dropdown-Menü für Filter */
    .filter-dropdown {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      background-color: white;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      z-index: 5;
      padding: 6px 0;
      min-width: 160px;
    }

    .filter-dropdown button {
      width: 100%;
      background: none;
      border: none;
      padding: 10px 14px;
      text-align: left;
      font-size: 14px;
      cursor: pointer;
    }

    .filter-dropdown button:hover {
      background-color: #f0f0f0;
    }

    .filter-wrapper:hover .filter-dropdown {
      display: block; /* Zeigt Dropdown bei Hover */
    }

    /* === FOOTER MIT NAVIGATION === */
    /* Footer mit Navigation (fixiert am unteren Bildschirmrand) */
    footer {
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 1.5vh 0;
      border-top: 1px solid #ccc;
      background-color: #fff;
      position: fixed;
      bottom: 0;
      width: 100%;
    }

    footer img {
      width: 3vh;
      height: auto;
    }

    .active {
      filter: hue-rotate(220deg); /* Färbt das aktive Icon anders */
    }

    /* === SWIPE-ANIMATIONEN === */
    /* Animationen für das Swipen/Löschen von Karten */
    .card {
      transition: transform 0.3s ease, opacity 0.3s ease;
    }

    .swipe-left {
      transform: translateX(-100%);
      opacity: 0;
    }

    .card.fading {
      opacity: 0.4;
      transition: transform 0.3s ease, opacity 0.3s ease;
    }

    /* Mindesthöhe für Container */
    #relevant-container,
    #unspektakulaer-container {
      min-height: 40vh;
    }

    .footer-btn {
      background: none;
      border: none;
      padding: 0;
      margin: 0;
      cursor: pointer;
    }

    /* === INFO-POPUP === */
    /* Vollbild-Overlay für Info-Popups */
    .info-popup {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
    }

    /* Inhalt des Info-Popups */
    .info-content {
      background-color: white;
      padding: 2rem;
      border-radius: 12px;
      max-width: 90%;
      width: 400px;
      position: relative;
      text-align: left;
      font-size: 1rem;
      box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }

    /* Info-Button (ⓘ) */
    .info-button {
      position: relative;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.2rem;
    }

    /* Weitere Info-Button Styles */
    .info-button::after {
      content: attr(data-info);
      position: absolute;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      background-color: #333;
      color: white;
      padding: 6px 10px;
      border-radius: 6px;
      font-size: 0.9rem;
      white-space: normal;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
      width: 220px;
      z-index: 10;
    }

  </style>

  <style>
  /* === ZUSÄTZLICHE INFO-POPUP STYLES === */
  .info-popup {
    position: fixed;
    top: 0; left: 0;
    right: 0; bottom: 0;
    background-color: rgba(0,0,0,0.6);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 999;
  }

  .info-content {
    background: white;
    padding: 2rem;
    border-radius: 12px;
    max-width: 90%;
    width: 400px;
    text-align: left;
    position: relative;
  }

  .close-button {
    position: absolute;
    top: 12px;
    right: 12px;
    background: black;
    color: white;
    border: none;
    border-radius: 50%;
    width: 28px;
    height: 28px;
    font-size: 1.2rem;
    cursor: pointer;
  }

  .info-button {
  background: none;
  border: none;
  font-size: 1.8vh;
  cursor: pointer;
  color: inherit;
  padding: 0;
  margin: 0;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

.info-button:focus {
  outline: none;
}

.info-button:hover {
  background: none;
}
</style>

</head>
<body>
  <!-- === HEADER BEREICH === -->
  <header>
    Aktuelles

    <!-- Profil-Button mit Dropdown-Menü -->
    <button class="profile-button" onclick="toggleProfileMenu()" aria-label="Benutzer öffnen">
      <div class="profile-icon">
        <img src="/HedgeFin/HedgeFin/assets/Benutzer.png" alt="Benutzer" />
      </div>
    </button>

    <!-- Verstecktes Profil-Menü -->
    <div class="profile-menu" id="profileMenu">
      <button class="close-button" onclick="toggleProfileMenu()">×</button>
      <div class="icon-wrapper">
        <img src="/HedgeFin/HedgeFin/assets/Benutzer.png" alt="Benutzer" />
      </div>
      <button class="logout-button" onclick="window.location.href='/HedgeFin/HedgeFin/page2.html'">Abmelden</button>
    </div>
  </header>

  <!-- === HAUPTINHALT === -->
  <div class="content">
    <!-- "Relevant" Sektion -->
    <div class="section-label red-label">Relevant</div>

    <!-- Filter-Dropdown -->
    <div class="filter-wrapper">
      <button class="filter-button">Filter ▾</button>
      <div class="filter-dropdown">
        <button onclick="setFilter('alle')">Alle</button>
        <button onclick="setFilter('favoriten')">Favoriten</button>
        <button onclick="setFilter('gelöscht')">Gelöscht</button>
      </div>
    </div>

    <!-- Container für relevante News-Karten -->
    <div id="relevant-container"></div>

    <!-- "Unspektakulär" Sektion -->
    <div style="margin-top: 4vh;">
      <div class="section-label purple-label">Unspektakulär</div>
      <div id="unspektakulaer-container"></div>
    </div>
  </div>

  <!-- === FOOTER MIT NAVIGATION === -->
  <footer>
  <button class="footer-btn" aria-label="News">
    <img src="/HedgeFin/HedgeFin/assets/icon-news.PNG" alt="News" class="active" />
  </button>

  <button class="footer-btn" aria-label="Chart"
        onmouseenter="showInfoMessage()"
        onmouseleave="hideInfoMessage()">
  <img src="/HedgeFin/HedgeFin/assets/icon-chart.PNG" alt="Chart" />
</button>

  <button class="footer-btn" aria-label="Einstellungen" onclick="window.location.href='/HedgeFin/HedgeFin/Maerkte2.html'">
    <img src="/HedgeFin/HedgeFin/assets/icon-settings.PNG" alt="Settings" />
  </button>
</footer>

  <script>
    // === DATEN FÜR NEWS-KARTEN ===
    // Array mit allen News-Karten Daten
    const cardsData = [
      {
        id: 'card-btc',
        title: 'Bitcoin Aufgenommen in US Cryptoreserve – Donald J. Trump',
        date: '24. März 2025',
        category: 'relevant',
        trend: 'green',
        trendLabel: 'BTC ↑'
      },
      {
        id: 'card-fed',
        title: 'Federal Reserve – Zentralbank USA',
        date: '16. Juli 2025',
        category: 'relevant',
        trend: 'green',
        trendLabel: 'DOW Jones ↑'
      },
      {
        id: 'card-apple',
        title: 'Tim Cook – Hauptaktionär von Apple verkauft Anteile',
        date: '10. Juli 2025',
        category: 'relevant',
        trend: 'red',
        trendLabel: 'Apple ↓'
      },
      {
        id: 'card-zoll',
        title: 'Trump kündigt 30 % Zölle auf EU und Mexiko an',
        date: '11. Juli 2025',
        category: 'unspektakulaer',
        trend: 'red',
        trendLabel: 'DAX Unternehmen ↓'
      },
      {
        id: 'card-china',
        title: 'Trump „Liberation Day"-Zölle gegen China',
        date: '3. April 2025',
        category: 'unspektakulaer',
        trend: 'red',
        trendLabel: 'Tencent Holding ↓'
      },
      {
        id: 'card-zins',
        title: 'Federal Reserve veröffentlicht Zinsprotokoll',
        date: '19. Februar 2025',
        category: 'unspektakulaer',
        trend: 'green',
        trendLabel: 'S&P 500 ↑'
      }
    ];

    // Aktueller Filter-Status
    let currentFilter = 'alle';

    // === PROFIL-MENÜ FUNKTIONEN ===
    function toggleProfileMenu() {
      document.getElementById("profileMenu").classList.toggle("active");
    }

    // === FAVORITEN-FUNKTIONEN ===
    // Favoriten-Status umschalten und in LocalStorage speichern
    function toggleFavorite(button) {
      const card = button.closest('.card');
      const cardId = card.dataset.id;

      let favorites = JSON.parse(localStorage.getItem('favorites')) || [];

      if (favorites.includes(cardId)) {
        favorites = favorites.filter(id => id !== cardId);
        if (currentFilter === 'favoriten') card.remove();
      } else {
        favorites.push(cardId);
      }

      localStorage.setItem('favorites', JSON.stringify(favorites));
      renderCards(currentFilter);
    }

    // === KARTEN-LÖSCHFUNKTIONEN ===
    // Karte permanent aus der Anzeige entfernen
    function permanentlyRemoveCard(cardId) {
      let removed = JSON.parse(localStorage.getItem('removedCards')) || [];
      if (!removed.includes(cardId)) {
        removed.push(cardId);
        localStorage.setItem('removedCards', JSON.stringify(removed));
      }
    }

    // === HAUPT-RENDER-FUNKTION ===
    // Rendert alle Karten basierend auf dem aktuellen Filter
    function renderCards(filter = 'alle') {
  const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
  const removed = JSON.parse(localStorage.getItem('removedCards')) || [];
  const showDeleted = filter === 'gelöscht';

  const relevantContainer = document.getElementById('relevant-container');
  const unspektakulaerContainer = document.getElementById('unspektakulaer-container');

  // Container leeren vor dem Neurendern
  relevantContainer.innerHTML = '';
  unspektakulaerContainer.innerHTML = '';

  // Durch alle Karten iterieren und basierend auf Filter anzeigen
  cardsData.forEach(card => {
    const isFav = favorites.includes(card.id);
    const isDeleted = removed.includes(card.id);

    // Filter-Logik
    if (!showDeleted && isDeleted) return;
    if (showDeleted && !isDeleted) return;
    if (filter === 'favoriten' && !isFav) return;

    // Bestimme den richtigen Container
    const container = card.category === 'relevant' ? relevantContainer : unspektakulaerContainer;

    // Erstelle Karten-Element
    const el = document.createElement('div');
    el.className = 'card';
    el.dataset.id = card.id;

    // Touch- und Mouse-Event-Handler für Swipe-Funktionalität
    el.setAttribute('onmousedown', 'handleMouseDown(event, this)');
    el.setAttribute('ontouchstart', 'handleTouchStart(event, this)');
    el.setAttribute('ontouchmove', 'handleTouchMove(event)');
    el.setAttribute('ontouchend', 'handleTouchEnd(event)');

    // HTML-Inhalt der Karte
    el.innerHTML = `
      <div class="card-info">
        <div class="card-header">${card.title}</div>
        <div class="card-sub">${card.date}</div>
      </div>
      <div class="card-right">
        <div class="${card.trend}">${card.trendLabel}</div>
        <div>
          <button class="info-button" onclick="openInfo('${card.id}')">ⓘ</button>
          <button class="favorite-button ${isFav ? 'favorited' : ''}" onclick="toggleFavorite(this)">
            ${isFav ? '★' : '☆'}
          </button>
        </div>
      </div>
    `;

    container.appendChild(el);
  });
}

    // === FILTER-FUNKTIONEN ===
    function setFilter(filter) {
      currentFilter = filter;
      renderCards(filter);
    }

    // === SWIPE-FUNKTIONALITÄT ===
    // Variablen für Swipe-Gesten
    let startX = 0;
    let currentCard = null;
    let isDragging = false;
    let autoSwiped = false;

    // Startet die Swipe-Geste
    function startSwipe(x, el) {
      startX = x;
      currentCard = el;
      isDragging = true;
      autoSwiped = false;
      currentCard.style.transition = 'none';
      currentCard.style.opacity = '1';
    }

    // Verarbeitet die Bewegung während des Swipes
    function moveSwipe(x) {
      if (!isDragging || !currentCard || autoSwiped) return;
      const dx = x - startX;

      if (dx < 0) {
        currentCard.style.transform = `translateX(${dx}px)`;
        const fadeEnd = -currentCard.offsetWidth;
        const clampedDx = Math.max(fadeEnd, dx);
        const opacity = 1 + (clampedDx / Math.abs(fadeEnd));
        currentCard.style.opacity = Math.max(opacity, 0.2);

        // Auto-Swipe bei 25% der Kartenbreite
        const threshold = currentCard.offsetWidth * 0.25;
        if (Math.abs(dx) > threshold) {
          autoSwiped = true;
          currentCard.style.transition = 'transform 0.3s ease, opacity 0.3s ease';
          currentCard.style.transform = `translateX(-100%)`;
          currentCard.style.opacity = '0';

          // Karte nach Animation entfernen
          setTimeout(() => {
  const cardId = currentCard.dataset.id;

  if (currentFilter === 'gelöscht') {
    // Karte wiederherstellen
    let removed = JSON.parse(localStorage.getItem('removedCards')) || [];
    removed = removed.filter(id => id !== cardId);
    localStorage.setItem('removedCards', JSON.stringify(removed));
  } else {
    // Karte löschen
    permanentlyRemoveCard(cardId);
  }

  currentCard.remove();
  currentCard = null;
}, 300);
          isDragging = false;
        }
      }
    }

    // Beendet die Swipe-Geste
    function endSwipe(x) {
      if (!isDragging || !currentCard || autoSwiped) return;
      const diff = startX - x;
      const cardWidth = currentCard.offsetWidth;
      const percentSwiped = diff / cardWidth;

      currentCard.style.transition = 'transform 0.3s ease, opacity 0.3s ease';

      if (percentSwiped > 0.25) {
        // Karte komplett wegswipen
        currentCard.style.transform = 'translateX(-100%)';
        currentCard.style.opacity = '0';
        setTimeout(() => {
  const cardId = currentCard.dataset.id;

  if (currentFilter === 'gelöscht') {
    let removed = JSON.parse(localStorage.getItem('removedCards')) || [];
    removed = removed.filter(id => id !== cardId);
    localStorage.setItem('removedCards', JSON.stringify(removed));
  } else {
    permanentlyRemoveCard(cardId);
  }

  currentCard.remove();
}, 300);
      } else {
        // Karte zurückspringen lassen
        currentCard.style.transform = 'translateX(0)';
        currentCard.style.opacity = '1';
      }

      isDragging = false;
      currentCard = null;
    }

    // === TOUCH-EVENT-HANDLER ===
    function handleTouchStart(e, el) {
      startSwipe(e.touches[0].clientX, el);
    }

    function handleTouchMove(e) {
      moveSwipe(e.touches[0].clientX);
    }

    function handleTouchEnd(e) {
      endSwipe(e.changedTouches[0].clientX);
    }

    // === MOUSE-EVENT-HANDLER ===
    function handleMouseDown(e, el) {
      startSwipe(e.clientX, el);
      document.addEventListener('mousemove', handleMouseMove);
      document.addEventListener('mouseup', handleMouseUp);
    }

    function handleMouseMove(e) {
      moveSwipe(e.clientX);
    }

    function handleMouseUp(e) {
      endSwipe(e.clientX);
      document.removeEventListener('mousemove', handleMouseMove);
      document.removeEventListener('mouseup', handleMouseUp);
    }

    // === INITIALISIERUNG ===
    // Rendert die Karten beim Laden der Seite
    window.addEventListener('DOMContentLoaded', () => {
      renderCards();
    });
  </script>
  
  <!-- === INFO-POPUP HTML === -->
<div id="info-popup" class="info-popup" style="display: none;">
  <div class="info-content">
    <button class="close-button" onclick="closeInfo()">×</button>
    <p id="info-text">Hier steht der Infotext...</p>
  </div>
</div>

<script>
  // === INFO-TEXTE FÜR POPUP ===
  // Detaillierte Informationen für jede News-Karte
  const infoTexts = {
    'card-btc': `Bitcoin ist offiziell in die US CryptoReserve aufgenommen worden. Die neue Digitalwährungsreserve ergänzt künftig Gold- und Devisenbestände der Vereinigten Staaten. Ex-Präsident Donald J. Trump begrüßte die Entscheidung als „Schritt in Richtung technologischer Vorreiterrolle", forderte aber zugleich „klare Regelwerke", um Privatanleger vor möglichen Risiken zu schützen.`,
    
    'card-fed': `Die US-Notenbank Federal Reserve hat gerade auf ihrer Sitzung den Leitzins unverändert im Korridor von 4,25 %–4,50 % belassen. Fed-Chef Jerome Powell wies darauf hin, dass die Kerninflationsrate von 2,7 % noch zu hoch sei, um Zinssenkungen zu rechtfertigen, und hob die anhaltenden Effekte der Zollpolitik hervor.`,

    'card-apple': `Apple-CEO Tim Cook hat gerade 108.136 Apple-Aktien im Wert von rund 24,2 Mio. USD verkauft. Die Transaktionen erfolgten laut SEC-Meldung zu Kursen zwischen 221,77 und 224,76 USD pro Aktie. Das verkaufte Paket stammte aus gerade erst vesteten Restricted Stock Units.`,

    'card-zoll': `Donald J. Trump kündigte gerade an, Zölle von 30 % auf alle Wareneinfuhren aus der EU und Mexiko zu erheben. Die Maßnahme soll innerhalb von 60 Tagen in Kraft treten und zielt laut Trump auf „fairen Handel" und den Schutz amerikanischer Arbeitsplätze ab.`,

    'card-china': `Donald J. Trump kündigte heute zum „Liberation Day" Strafzölle von 30 % auf Importe aus China an. Er begründete den Schritt mit „unfairen Handelspraktiken" Pekings und dem Schutz amerikanischer Arbeitsplätze.`,

    'card-zins': `Die Federal Reserve hat gerade die Protokolle der FOMC-Sitzung veröffentlicht. Sie zeigen, dass nur „ein paar" Mitglieder eine Zinssenkung noch in diesem Monat befürworteten, während die Mehrheit weiter vor Inflation durch US-Zölle warnte. Die Märkte peilen nun eine erste Senkung im September an.`
  };
</script>

<script>
  // === INFO-POPUP FUNKTIONEN ===
  // Öffnet das Info-Popup mit entsprechendem Text
  function openInfo(cardId) {
    const text = infoTexts[cardId] || 'Keine Information verfügbar.';
    document.getElementById('info-text').textContent = text;
    document.getElementById('info-popup').style.display = 'flex';
  }

  // Schließt das Info-Popup
  function closeInfo() {
    document.getElementById('info-popup').style.display = 'none';
  }
</script>

<!-- Info-Popup HTML (doppelt definiert im Original) -->
<div id="info-popup" class="info-popup" style="display: none;">
  <div class="info-content">
    <button class="close-button" onclick="closeInfo()">×</button>
    <p id="info-text">Hier steht der Infotext...</p>
  </div>
</div>
</body>
</html>